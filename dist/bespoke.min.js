/*! Bespoke.js v0.0.1-alpha-8 | (c) 2013 Mark Dalgleish | Licensed MIT */
(function(e,t,n){"use strict";var r=[],i={},s=function(e,t,n){(e[t]||(e[t]=[])).push(n)},o=function(e,t,n){(e[t]||[]).reduce(function(e){return e!==n})},u=function(e,t,n){(e[t]||[]).concat(e!==i&&i[t]||[]).map(function(e){setTimeout(e.bind(null,n),0)})},a=function(e,t){var i=n.querySelector(e),a=[].slice.call(i.children,0),f=a[0],c={},d=function(e){if(!a[e])return;u(c,"deactivate",{slide:f,index:a.indexOf(f)}),f=a[e],a.map(v),h(f,"active"),p(f,"inactive"),u(c,"activate",{slide:f,index:e})},v=function(e,t){["before","before-\\d+","after","after-\\d+","active","inactive"].map(p.bind(null,e));if(e===f)return;var n=t-a.indexOf(f),r=n>0?"after":"before";["inactive",r,r+"-"+Math.abs(n)].map(h.bind(null,e))},m=function(){d(a.indexOf(f)+1)},g=function(){d(a.indexOf(f)-1)},y={on:s.bind(null,c),off:o.bind(null,c),slide:d,next:m,prev:g,parent:i,slides:a};return d(0),h(i,"parent"),a.map(function(e){h(e,"slide")}),Object.keys(t||{}).map(function(e){var n=t[e];n&&l[e](y,n===!0?{}:n)}),r.push(y),y},f=function(e){return function(t){var r,i,s=function(t){return function(n){n.preventDefault(),n.touches.length===1&&t(n.touches[0]["page"+e])}};n.addEventListener("keydown",function(n){var r=n.which;e==="X"?(r===37&&t.prev(),(r===32||r===39)&&t.next()):(r===38&&t.prev(),(r===32||r===40)&&t.next())}),n.addEventListener("touchstart",s(function(e){r=e})),n.addEventListener("touchmove",s(function(e){i=e-r})),n.addEventListener("touchend",function(){if(Math.abs(i)<100)return;i>0?t.prev():t.next()})}},l={horizontal:f("X"),vertical:f("Y")},c=function(t){return e+"-"+t},h=function(e,t){e.className+=" "+c(t)},p=function(e,t){t=c(t);var n=new RegExp("(\\s|^)"+t+"(\\s|$)","gi");n.test(e.className)&&(e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,""))},d=function(e){return function(t){r.map(function(n){n[e].call(null,t)})}},v=function(e){return{from:function(t,n){return(n=n||{})[e]=!0,a(t,n)}}};t[e]={from:a,slide:d("slide"),next:d("next"),prev:d("prev"),horizontal:v("horizontal"),vertical:v("vertical"),on:s.bind(null,i),off:o.bind(null,i),plugins:l,decks:r}})("bespoke",this,document);