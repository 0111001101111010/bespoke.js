/*! Bespoke.js v0.0.1-alpha-10 | (c) 2013 Mark Dalgleish | Licensed MIT */
(function(e,t,n){var r=[],i={},s=function(e,t,n){(e[t]||(e[t]=[])).push(n)},o=function(e,t,n){(e[t]||[]).filter(function(e){return e!==n})},u=function(e,t,n){return(e[t]||[]).concat(e!==i&&i[t]||[]).reduce(function(e,t){return t(n)!==!1&&e},1)},a=function(e,t){var i=n.querySelector(e),a=[].slice.call(i.children,0),f=a[0],p={},d=function(e){if(!a[e])return;u(p,"deactivate",{slide:f,index:a.indexOf(f)}),f=a[e],a.map(v),c(f,"active"),h(f,"inactive"),u(p,"activate",{slide:f,index:e})},v=function(e,t){var n=t-a.indexOf(f),r=n>0?"after":"before";["before","before-\\d+","after","after-\\d+","active","inactive"].map(h.bind(null,e)),e!==f&&["inactive",r,r+"-"+Math.abs(n)].map(c.bind(null,e))},m=function(){u(p,"next",{slide:f,index:a.indexOf(f)})&&d(a.indexOf(f)+1)},g=function(){u(p,"prev",{slide:f,index:a.indexOf(f)})&&d(a.indexOf(f)-1)},y={on:s.bind(null,p),off:o.bind(null,p),slide:d,next:m,prev:g,parent:i,slides:a};return d(0),c(i,"parent"),a.map(function(e){c(e,"slide")}),Object.keys(t||{}).map(function(e){var n=t[e];n&&l[e](y,n===!0?{}:n)}),r.push(y),y},f=function(e){return function(t){var r,i;n.addEventListener("keydown",function(n){var r=n.which;e==="X"?(r===37&&t.prev(),(r===32||r===39)&&t.next()):(r===38&&t.prev(),(r===32||r===40)&&t.next())}),t.parent.addEventListener("touchstart",function(t){t.touches.length===1&&(r=t.touches[0]["page"+e],i=0)}),t.parent.addEventListener("touchmove",function(t){t.touches.length===1&&(t.preventDefault(),i=t.touches[0]["page"+e]-r)}),t.parent.addEventListener("touchend",function(){Math.abs(i)>50&&(i>0?t.prev():t.next())})}},l={horizontal:f("X"),vertical:f("Y")},c=function(t,n){t.classList.add(e+"-"+n)},h=function(t,n){t.classList.remove(e+"-"+n)},p=function(e){return function(t){r.map(function(n){n[e].call(null,t)})}},d=function(e){return{from:function(t,n){return(n=n||{})[e]=!0,a(t,n)}}};t[e]={from:a,slide:p("slide"),next:p("next"),prev:p("prev"),horizontal:d("horizontal"),vertical:d("vertical"),on:s.bind(null,i),off:o.bind(null,i),plugins:l,decks:r}})("bespoke",this,document);